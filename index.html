<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ch√° Rifa do Gustavo</title>
  <style>
    /* MESMO CSS QUE J√Å TEMOS */
  </style>
</head>
<body>

<h1>Ch√° Rifa do Gustavo</h1>
<p>Escolha seu n√∫mero e clique em "Enviar"</p>

<div class="grid" id="grid"></div>

<button id="enviarBtn">Enviar para WhatsApp</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>

<script>
// CONFIGURA√á√ÉO FIREBASE
const firebaseConfig = {
  apiKey: "AIzaSyAYqXPz6HqhZHv4oaMwsRlQ8R5esIxSdZQ",
  authDomain: "charifagustavo.firebaseapp.com",
  databaseURL: "https://charifagustavo-default-rtdb.firebaseio.com",
  projectId: "charifagustavo",
  storageBucket: "charifagustavo.firebasestorage.app",
  messagingSenderId: "436323759753",
  appId: "1:436323759753:web:1e9a3786637389d0dc7858"
};
firebase.initializeApp(firebaseConfig);

const database = firebase.database();
const grid = document.getElementById('grid');
const seuNumeroWhatsapp = '5541984203644';
let numeroSelecionado = null;

// Carregar os n√∫meros e ouvir altera√ß√µes
function carregarNumeros() {
  database.ref('reservas').on('value', (snapshot) => {
    const reservas = snapshot.val() || {};
    grid.innerHTML = '';

    for (let i = 1; i <= 100; i++) {
      const div = document.createElement('div');
      div.className = 'number';
      div.innerText = i;

      if (reservas[i]) {
        div.classList.add('reserved');
        div.innerText = i + "\nüö´";
        div.title = "Reservado";
      } else {
        div.addEventListener('click', function() {
          const anterior = document.querySelector('.selected');
          if (anterior) anterior.classList.remove('selected');
          div.classList.add('selected');
          numeroSelecionado = i;
        });
      }

      grid.appendChild(div);
    }
  });
}

carregarNumeros();

// Bot√£o enviar para WhatsApp e reservar no Firebase
document.getElementById('enviarBtn').addEventListener('click', function() {
  if (!numeroSelecionado) {
    alert('Por favor, selecione um n√∫mero primeiro!');
    return;
  }

  const confirmacao = confirm(`Deseja mesmo reservar o n√∫mero ${numeroSelecionado}?`);
  if (!confirmacao) return;

  // Grava no Firebase
  database.ref('reservas/' + numeroSelecionado).set(true)
    .then(() => {
      const mensagem = `Ol√°! Gostaria de reservar o n√∫mero ${numeroSelecionado} para o Ch√° Rifa do Gustavo.`;
      const url = `https://wa.me/${seuNumeroWhatsapp}?text=${encodeURIComponent(mensagem)}`;
      window.open(url, '_blank');
    })
    .catch((error) => {
      alert('Erro ao reservar o n√∫mero. Tente novamente.');
      console.error(error);
    });
});
</script>

</body>
</html>
